(function(n){"use strict";n.module("esri.map",[]);n.module("esri.map").factory("esriLoader",["$q",function(t){return function(i,r){var u=t.defer();return n.isString(i)?require([i],function(n){r!==null&&r!==undefined&&r(n);u.resolve(n)}):n.isArray(i)?require(i,function(){r!==null&&r!==undefined&&r.apply(this,arguments);u.resolve(arguments)}):u.reject("An Array<String> or String is required to load modules."),u.promise}}])})(angular),function(n){"use strict";n.module("esri.map").service("esriRegistry",["$q",function(n){var t={};return{_register:function(i,r){t[i]||(t[i]=n.defer());var u=t[i];return r.promise.then(function(n){return u.resolve(n),n},function(n){return u.reject(n),n}),function(){delete t[i]}},get:function(i){if(t[i])return t[i].promise;var r=n.defer();return t[i]=r,r.promise}}}])}(angular),function(n){"use strict";n.module("esri.map").directive("esriMap",["$q","$timeout","esriRegistry",function(t,i,r){return{restrict:"E",scope:{center:"=?",zoom:"=?",itemInfo:"=?",basemap:"@",load:"&",extentChange:"&"},compile:function(n,t){return n.removeAttr("id"),n.append("<div id="+t.id+"><\/div>"),function(){}},controller:function(u,f,e){var o=t.defer(),s;e.registerAs&&(s=r._register(e.registerAs,o),u.$on("$destroy",s));require(["esri/map","esri/arcgis/utils"],function(t,r){var f,s,h,c,l;if(e.webmapId)r.createMap(e.webmapId,e.id).then(function(n){o.resolve(n.map);var t=n.map.geographicExtent.getCenter();u.center.lng=t.x;u.center.lat=t.y;u.zoom=n.map.getZoom();u.itemInfo=n.itemInfo});else{if(f={},e.extent?f.extent=u[e.extent]:(u.center.lng&&u.center.lat?f.center=[u.center.lng,u.center.lat]:u.center&&(f.center=u.center),u.zoom&&(f.zoom=u.zoom)),u.basemap&&(f.basemap=u.basemap),e.navigationMode)if(e.navigationMode!=="css-transforms"&&e.navigationMode!=="classic")throw new Error("navigationMode must be 'css-transforms' or 'classic'.");else f.navigationMode=e.navigationMode;if(e.sliderOrientation)if(e.sliderOrientation!=="horizontal"&&e.sliderOrientation!=="vertical")throw new Error("sliderOrientation must be 'horizontal' or 'vertical'.");else f.sliderOrientation=e.sliderOrientation;if(e.sliderPosition)if(s=["top-left","top-right","bottom-left","bottom-right"],s.indexOf(e.sliderPosition)<0)throw new Error("sliderPosition must be in "+s);else f.sliderPosition=e.sliderPosition;if(e.sliderStyle)if(e.sliderStyle!=="large"&&e.sliderStyle!=="small")throw new Error("sliderStyle must be 'large' or 'small'.");else f.sliderStyle=e.sliderStyle;h=["autoResize","displayGraphicsOnPan","fadeOnZoom","fitExtent","force3DTransforms","logo","nav","optimizePanAnimation","showAttribution","showInfoWindowOnClick","slider","smartNavigation","wrapAround180"];n.forEach(h,function(n){typeof e[n]!="undefined"&&(f[n]=e[n].toString()==="true")});c=["attributionWidth","maxScale","maxZoom","minScale","minZoom","resizeDelay","scale"];n.forEach(c,function(n){e[n]&&(f[n]=e[n])});l=new t(e.id,f);o.resolve(l)}o.promise.then(function(n){n.on("load",function(){e.load&&u.$apply(function(){u.load()(n)})});u.$watch("basemap",function(t,i){n.loaded&&t!==i&&n.setBasemap(t)});u.inUpdateCycle=!1;u.$watch(function(n){return[n.center.lng,n.center.lat,n.zoom].join(",")},function(t,i){u.inUpdateCycle||(console.log("center/zoom changed",t,i),t=t.split(","),t[0]!==""&&t[1]!==""&&t[2]!==""&&(u.inUpdateCycle=!0,n.centerAndZoom([t[0],t[1]],t[2]).then(function(){console.log("after centerAndZoom()");u.inUpdateCycle=!1})))});n.on("extent-change",function(t){u.inUpdateCycle||(u.inUpdateCycle=!0,console.log("extent-change geo",n.geographicExtent),u.$apply(function(){var r=n.geographicExtent.getCenter();u.center.lng=r.x;u.center.lat=r.y;u.zoom=n.getZoom();e.extentChange&&u.extentChange()(t);i(function(){console.log("after apply()");u.inUpdateCycle=!1},0)}))});u.$on("$destroy",function(){n.destroy()})})});this.getMap=function(){return o.promise};this.addLayer=function(n){return this.getMap().then(function(t){return t.addLayer(n)})};this.addLayerInfo=function(n){this.layerInfos?this.layerInfos.push(n):this.layerInfos=[n]};this.getLayerInfos=function(){return this.layerInfos}}}}])}(angular),function(n){"use strict";n.module("esri.map").directive("esriFeatureLayer",["$q",function(n){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:function(t,i,r){var u=n.defer();require(["esri/layers/FeatureLayer"],function(n){var e=/(http:\/\/|https:\/\/)/.test(r.url),i,f;i=e?r.url:t.$eval(r.url);f=new n(i);u.resolve(f)});this.getLayer=function(){return u.promise};this.setVisible=function(t){var i=n.defer();return this.getLayer().then(function(n){t===!0||t.toString().toLowerCase()==="true"?n.show():(t===!1||t.toString().toLowerCase()==="false")&&n.hide();i.resolve()}),i.promise}},link:function(n,t,i,r){var u=r[0],f=r[1],e=i.visible||!0,o=n.$eval(e);u.setVisible(o);n.$watch(function(){return n.$eval(i.visible)},function(n,t){n!==t&&u.setVisible(n)});u.getLayer().then(function(n){return f.addLayer(n),f.addLayerInfo({title:i.title||n.name,layer:n,hideLayers:i.hideLayers?i.hideLayers.split(","):undefined,defaultSymbol:i.defaultSymbol?JSON.parse(i.defaultSymbol):!0}),n})}}}])}(angular),function(n){"use strict";n.module("esri.map").directive("esriLegend",["$document","$q",function(t,i){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(t,r,u,f){var e=f[0],o=u.targetId||u.id,s=i.defer();require(["esri/dijit/Legend","dijit/registry"],function(i,r){e.getMap().then(function(u){var h={map:u},c=e.getLayerInfos(),f;c&&(h.layerInfos=c);f=r.byId(o);f&&f.destroyRecursive();f=new i(h,o);f.startup();t.layers=f.layers;n.forEach(t.layers,function(n,i){t.$watch("layers["+i+"].renderer",function(){f.refresh()})});s.resolve(f)})})}}}])}(angular);
//# sourceMappingURL=angular-esri-map.min.js.map
